!function(){var t,e,n={};function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var o=0,r=function(){};return{s:r,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,a=!0,i=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){i=!0,u=t},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw u}}}}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:void 0;Office.onReady((function(n){for(var o in t=Office.context.mailbox.item,e=Office.context.mailbox,u){var s=u[o];r[s.globalFunction]=d(s)}console.log("Office.js is now ready in ".concat(n.host," on ").concat(n.platform))})),r.validateBody=function(e){!function(e){t.subject.getAsync({asyncContext:e},(function(e){var n=e.value,o=f(n);if(!o)return t.notificationMessages.addAsync("NoSend",{type:"errorMessage",message:"Please choose a classification for this email."}),void e.asyncContext.completed({allowEvent:!1});Office.context.mailbox.item.saveAsync((function(s){!function(t,e,n,o){if(!t)return console.log("Ignoring invalid itemId in setCategory: "+t),void o(n);m(g('<UpdateItem MessageDisposition="SaveOnly" ConflictResolution="AlwaysOverwrite" xmlns="http://schemas.microsoft.com/exchange/services/2006/messages">\n\t\t\t<ItemChanges>\n\t\t\t\t<t:ItemChange>\n\t\t\t\t\t<t:ItemId Id="'+t+'"/>\n\t\t\t\t\t<t:Updates>\n\t\t\t\t\t\t<t:SetItemField>\n\t\t\t\t\t\t\t<t:ExtendedFieldURI PropertySetId="00020329-0000-0000-C000-000000000046" PropertyName="Keywords" PropertyType="StringArray" />\n\t\t\t\t\t\t\t<t:Message>\n\t\t\t\t\t\t\t\t<t:ExtendedProperty>\n\t\t\t\t\t\t\t\t\t<t:ExtendedFieldURI PropertySetId="00020329-0000-0000-C000-000000000046" PropertyName="Keywords" PropertyType="StringArray" />\n\t\t\t\t\t\t\t\t\t<t:Values>\n\t\t\t\t\t\t\t\t\t\t<t:Value>'+e+"</t:Value>\n\t\t\t\t\t\t\t\t\t</t:Values>\n\t\t\t\t\t\t\t\t</t:ExtendedProperty>\n\t\t\t\t\t\t\t</t:Message>\n\t\t\t\t\t\t</t:SetItemField>\n\t\t\t\t\t</t:Updates>\n\t\t\t\t</t:ItemChange>\n\t\t\t</ItemChanges>\n\t\t</UpdateItem>"),(function(t){console.log("Successfully set category: "+t),o(n)}),(function(t){console.log("Error setting category: "+t),o(n)}))}(s.value,o.name,e.asyncContext,(function(e){!function(e,n){t.subject.setAsync(e,{asyncContext:n},(function(e){e.status==Office.AsyncResultStatus.Failed?(t.notificationMessages.addAsync("NoSend",{type:"errorMessage",message:"Unable to set the subject."}),e.asyncContext.completed({allowEvent:!1})):e.asyncContext.completed({allowEvent:!0})}))}(n=F(n),e)}))}))}))}(e)};var u={white:{name:"TLP White",globalFunction:"actionMarkWhite",subject:"[Classified White âšª]",icon80:"Icon.80x80"},green:{name:"TLP Green",globalFunction:"actionMarkGreen",subject:"[Classified Green ðŸŸ¢]",icon80:"IconGreen.80x80"},amber:{name:"TLP Amber",globalFunction:"actionMarkAmber",subject:"[Classified Amber ðŸŸ ]",icon80:"IconOrange.80x80"},red:{name:"TLP Red",globalFunction:"actionMarkRed",subject:"[Classified Red ðŸ”´]",icon80:"IconRed.80x80"}},a=/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\[cla[s\u017F][s\u017F]ified (white|green|amber|red) (?:[\0-\/:-@\[-\^`\{-\u017E\u0180-\u2129\u212B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])\][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*/gi,i=/^(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]?re:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]?|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]?aw:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]?)*[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\[cla[s\u017F][s\u017F]ified (white|green|amber|red) (?:[\0-\/:-@\[-\^`\{-\u017E\u0180-\u2129\u212B-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])\](?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*/i;function c(t){return t.replace(a," ").trim()}function l(t,e){return t?t.subject+" "+e:e}function f(t){if(t=t.toLowerCase(),i.test(t)){var e=t.match(i);return u[e[1]]}return null}function F(t){var e=f(t);return e?t=l(e,t=c(t)):t}function d(e){return function(n){var s,r,u={type:Office.MailboxEnums.ItemNotificationMessageType.InformationalMessage,message:"Marked message "+e.name,icon:e.icon80,persistent:!1},a={type:Office.MailboxEnums.ItemNotificationMessageType.ErrorMessage,message:"Failed to mark message (requested "+e.name+")"};s=e,r=function(t){t?Office.context.mailbox.item.notificationMessages.replaceAsync("action",u):Office.context.mailbox.item.notificationMessages.replaceAsync("action",a),n.completed()},function(t,e,n){t||e([]);var s='       <m:GetConversationItems>           <m:ItemShape>               <t:BaseShape>IdOnly</t:BaseShape>               <t:AdditionalProperties>                   <t:FieldURI FieldURI="item:Subject" />                   <t:FieldURI FieldURI="item:DateTimeReceived" />               </t:AdditionalProperties>           </m:ItemShape>           <m:FoldersToIgnore>               <t:DistinguishedFolderId Id="deleteditems" />               <t:DistinguishedFolderId Id="drafts" />           </m:FoldersToIgnore>           <m:SortOrder>TreeOrderDescending</m:SortOrder>           <m:Conversations>               <t:Conversation>                   <t:ConversationId Id="'+t+'" />               </t:Conversation>           </m:Conversations>       </m:GetConversationItems>';m(s=g(s),(function(t){var n,s,r,u,a,i=[],c=o((s=t,u=(r="t:Subject").substring(r.indexOf(":")+1),null!=(a=s.getElementsByTagName(r))&&0!=a.length||(a=s.getElementsByTagName(u)),a));try{for(c.s();!(n=c.n()).done;){var l=n.value;i.push(l.textContent)}}catch(t){c.e(t)}finally{c.f()}e(i)}),(function(t){null!=n&&n()}))}(t.conversationId,(function(e){var n,u=!1,a="",i=o(e);try{for(i.s();!(n=i.n()).done;){value=n.value;var d=f(value);if(d){u=!0,a=d;break}}}catch(t){i.e(t)}finally{i.f()}t.subject.getAsync((function(e){if(e.status==Office.AsyncResultStatus.Failed)console.log(e.error.message),r(!1);else{var n=e.value,o=f(n);if(o)if(u){if(o.subject!==a.subject||a.subject!==s.subject)return void r(!1);n=F(n)}else n=c(n),n=l(s,n);else n=l(u?a:s,n);t.subject.setAsync(n,null,(function(t){t.status==Office.AsyncResultStatus.Failed?(console.log(t.error.message),r(!1)):r(!0)}))}}))}),(function(t){r(!1)}))}}function m(t,n,o){e.makeEwsRequestAsync(t,(function(t){if(t.status===Office.AsyncResultStatus.Succeeded){console.log("makeEwsRequestAsync success. "+t.status);var e=(new DOMParser).parseFromString(t.value,"text/xml");n(e)}else console.log("makeEwsRequestAsync failed. "+t.error),o(t.error)}))}function g(t){return'<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"               xmlns:xsd="http://www.w3.org/2001/XMLSchema"               xmlns:m="http://schemas.microsoft.com/exchange/services/2006/messages"               xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/"               xmlns:t="http://schemas.microsoft.com/exchange/services/2006/types">   <soap:Header>       <RequestServerVersion Version="Exchange2013" xmlns="http://schemas.microsoft.com/exchange/services/2006/types" soap:mustUnderstand="0" />   </soap:Header>   <soap:Body>'+t+"</soap:Body></soap:Envelope>"}}();
//# sourceMappingURL=commands.js.map